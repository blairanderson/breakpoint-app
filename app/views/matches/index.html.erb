<% subtitle 'Matches' %>
<p><%= link_to 'Add a match', new_team_match_path(@team), :class => 'btn' %></p>

<% if @matches.empty? %>
  <div class="alert alert-block alert-info">
    <h4>No matches for this team yet.</h4>
    <%= link_to 'Add a match', new_team_match_path(@team) %> to get playing.
  </div>
<% else %>
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th style="width: 182px;">Can play?</th>
        <th>Date</th>
        <th>Location</th>
        <th>Setup Lineup</th>
        <th style="width: 193px;">&nbsp;</th>
      </tr>
    </thead>
    <tbody>
      <% @matches.each do |match| %>
        <tr>
          <td>
            <div class="pull-left">
              <% if match_availability = match.match_availability_for_user(current_user.id) %>
                <%= link_to "I can't play",
                  match_match_availability_path(match, match_availability),
                  :method => :delete,
                  :class => 'btn btn-small btn-warning' %>
              <% else %>
                <%= form_tag match_match_availabilities_path(match), :style => 'margin-bottom: 0px;' do %>
                  <%= submit_tag "I can play", :class => 'btn btn-small' %>
                <% end %>
              <% end %>
            </div>
            <div class="pull-right">
              <%= render :partial => 'match_availabilities', :locals => { :match => match } %>
            </div>
          </td>
          <td>
            <%= match.team_location %> on
            <%= l match.date, :format => :long %>
          </td>
          <td><%= simple_format match.location %></td>
          <td>
            <%= link_to 'Set the lineup', edit_lineup_match_path(match) %>
            <% if match.notified_team_lineup? %>
              <%= link_to 'Notify team', notify_lineup_match_path(match), :method => :post, :class => 'btn btn-small disabled' %>
            <% else %>
              <%= link_to 'Notify team', notify_lineup_match_path(match), :method => :post, :class => 'btn btn-small' %>
            <% end %>
          </td>
          <td>
            <% if match.notified_team? %>
              <%= link_to 'Notify team', notify_match_path(match), :method => :post, :class => 'btn btn-small disabled' %>
            <% else %>
              <%= link_to 'Notify team', notify_match_path(match), :method => :post, :class => 'btn btn-small' %>
            <% end %>
            <%= link_to 'Edit', edit_match_path(match), :class => 'btn btn-small' %>
            <%= link_to 'Delete',
              match_path(match),
              :data => { :confirm => 'Are you sure?' },
              :method => :delete,
              :class => 'btn btn-small btn-danger' %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>
